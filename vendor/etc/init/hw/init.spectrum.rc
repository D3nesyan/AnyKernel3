# SPECTRUM KERNEL MANAGER
# Ramdisk file for profile based kernel management
# Implimentation inspired by Franco's fku profiles

# Initialization
on property:sys.boot_completed=1
   #Fuck powerhal
   chown root root /dev/stune/top-app/schedtune.boost
   # Set default profile on first boot
   exec u:r:init:s0 root root -- /vendor/bin/init.spectrum.sh
   exec u:r:su:s0 root root -- /vendor/bin/init.spectrum.sh
   # Enable Spectrum support
   setprop spectrum.support 1
   # Add kernel name
   setprop persist.spectrum.kernel Barairo
   # Trigger selinux faker
   write /sys/fs/selinux/enforce 1

# Balance
on property:persist.spectrum.profile=0
    write /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor "schedutil"
    write /sys/devices/system/cpu/cpu4/cpufreq/scaling_governor "schedutil"
    
    write /dev/stune/top-app/schedtune.boost 10
    
    write /sys/module/boost_control/parameters/enable_fb_boost 0
    
    write /sys/module/boost_control/parameters/cpubw_boost_freq 4943
    
    write /sys/module/boost_control/parameters/dynamic_stune_boost 5
    
    write /sys/module/boost_control/parameters/app_launch_boost_ms 1000
    
    write /sys/devices/system/cpu/cpu0/cpufreq/schedhorizon/efficient_freq "1113600 1747200"
    write /sys/devices/system/cpu/cpu0/cpufreq/schedhorizon/up_delay "30 40"
    write /sys/devices/system/cpu/cpu4/cpufreq/schedhorizon/efficient_freq "1747200 2150400"
    write /sys/devices/system/cpu/cpu4/cpufreq/schedhorizon/up_delay "30 40"
    
    write /sys/module/boost_control/parameters/input_boost_freq_perf 1747200
    write /sys/module/boost_control/parameters/input_boost_freq_lp 1401600
    write /sys/module/boost_control/parameters/lmk_boost_ms 100

# Performance
on property:persist.spectrum.profile=1
    write /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor "performance"
    write /sys/devices/system/cpu/cpu4/cpufreq/scaling_governor "performance"
    
    write /dev/stune/top-app/schedtune.boost 0
    
    write /sys/module/boost_control/parameters/enable_fb_boost 0
    
    write /sys/module/boost_control/parameters/cpubw_boost_freq 6881
    
    write /sys/module/boost_control/parameters/dynamic_stune_boost 0
    
    write /sys/module/boost_control/parameters/app_launch_boost_ms 0
    
    write /sys/devices/system/cpu/cpu0/cpufreq/schedhorizon/efficient_freq "0"
    write /sys/devices/system/cpu/cpu0/cpufreq/schedhorizon/up_delay "0"
    write /sys/devices/system/cpu/cpu4/cpufreq/schedhorizon/efficient_freq "0"
    write /sys/devices/system/cpu/cpu4/cpufreq/schedhorizon/up_delay "0"
    
    write /sys/module/boost_control/parameters/input_boost_freq_perf 0
    write /sys/module/boost_control/parameters/input_boost_freq_lp 0
    write /sys/module/boost_control/parameters/lmk_boost_ms 0

# Battery
on property:persist.spectrum.profile=2
    write /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor "schedhorizon"
    write /sys/devices/system/cpu/cpu4/cpufreq/scaling_governor "schedhorizon"
    
    write /dev/stune/top-app/schedtune.boost 0
    
    write /sys/module/boost_control/parameters/enable_fb_boost 0
    
    write /sys/module/boost_control/parameters/cpubw_boost_freq 3879
    
    write /sys/module/boost_control/parameters/dynamic_stune_boost 0
    
    write /sys/module/boost_control/parameters/app_launch_boost_ms 0
    
    write /sys/devices/system/cpu/cpu0/cpufreq/schedhorizon/efficient_freq "0"
    write /sys/devices/system/cpu/cpu0/cpufreq/schedhorizon/up_delay "0"
    write /sys/devices/system/cpu/cpu4/cpufreq/schedhorizon/efficient_freq "0"
    write /sys/devices/system/cpu/cpu4/cpufreq/schedhorizon/up_delay "0"
    
    write /sys/module/boost_control/parameters/input_boost_freq_perf 0
    write /sys/module/boost_control/parameters/input_boost_freq_lp 0
    write /sys/module/boost_control/parameters/lmk_boost_ms 0

# Gaming
on property:persist.spectrum.profile=3
    write /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor "schedutil"
    write /sys/devices/system/cpu/cpu4/cpufreq/scaling_governor "schedutil"
    
    write /dev/stune/top-app/schedtune.boost 20
    
    write /sys/module/boost_control/parameters/enable_fb_boost 1
    
    write /sys/module/boost_control/parameters/cpubw_boost_freq 5931
    
    write /sys/module/boost_control/parameters/dynamic_stune_boost 50
    
    write /sys/module/boost_control/parameters/app_launch_boost_ms 1500
    
    write /sys/devices/system/cpu/cpu0/cpufreq/schedhorizon/efficient_freq "0"
    write /sys/devices/system/cpu/cpu0/cpufreq/schedhorizon/up_delay "0"
    write /sys/devices/system/cpu/cpu4/cpufreq/schedhorizon/efficient_freq "0"
    write /sys/devices/system/cpu/cpu4/cpufreq/schedhorizon/up_delay "0"
    
    write /sys/module/boost_control/parameters/input_boost_freq_perf 2150400
    write /sys/module/boost_control/parameters/input_boost_freq_lp 1747200
    write /sys/module/boost_control/parameters/lmk_boost_ms 1000
